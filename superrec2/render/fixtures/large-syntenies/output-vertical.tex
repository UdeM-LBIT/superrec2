\tikzset{
    x={1pt},
    y={-1pt},
    species border/.style={
        line width={1pt},
        shorten <={-1pt / 2 + 0.05pt},
        shorten >={-1pt / 2 + 0.05pt},
    },
    species label/.style={
        font=\bfseries,
        midway,
        yshift=-10
    },
    branch/.style={
        line width={0.5pt},
        preaction={
            draw, white, -{},
            line width={4pt},
            shorten <={0.5pt},
            shorten >={0.5pt},
        },
    },
    transfer branch/.style={
        branch,
        -Stealth,
    },
    loss/.style={
        draw, cross out, thick,
        line width={0.5pt},
        inner sep=0pt,
        outer sep=0pt,
        minimum width={3},
        minimum height={3},
    },
    extant gene/.style={
        circle, fill,
        outer sep=0pt, inner sep=0pt,
        minimum size={3},
        label={
            [font={{\strut}},
                    fill=white,
                    inner xsep=0pt, inner ysep=2pt,
                    outer xsep=0pt, outer ysep=0pt]
                below:#1
        },
    },
    branch node/.style={
        draw, fill=white,
        outer sep=0pt, inner xsep=0pt, inner ysep=2pt,
        line width={0.5pt},
    },
    speciation/.style={
        branch node, rounded rectangle,
        inner xsep=4pt,
        minimum width={8},
        minimum height={8},
    },
    duplication/.style={
        branch node, rectangle,
        inner xsep=4pt,
        minimum width={8},
        minimum height={8},
    },
    horizontal gene transfer/.style={
        branch node, signal, signal to=east and west,
        minimum width={8},
        minimum height={8},
    },
}
\begin{tikzpicture}
% species
\draw[species border] (231.62256000000002,53.71994000000001) |- (391.34359000000006,23.60999) -- (391.34359000000006,0);
\draw[species border] (557.9231050000001,143.18988000000002) |- (457.78052500000007,23.60999) -- (457.78052500000007,0);
\draw[species border] (322.50359000000003,53.71994000000001) |- (391.34359000000006,53.719939999999994) -| (519.6805250000001,143.18988000000002);
\draw[species border] (74.4,122.03989) |- (231.62256000000002,77.32993) -- (231.62256000000002,53.71994000000001);
\draw[species border] (391.34359000000006,210.01977) |- (322.50359000000003,77.32993) -- (322.50359000000003,53.71994000000001);
\draw[species border] (154.74256000000003,122.03989) |- (231.62256000000002,122.03989000000001) -| (322.50359000000003,210.01977);
\draw[species border] (0,210.01977) |- (74.4,132.03989) -- (74.4,122.03989);
\draw[species border] (231.62256000000002,178.80981) |- (154.74256000000003,132.03989) -- (154.74256000000003,122.03989);
\draw[species border] (74.4,210.01977) |- (74.4,178.80981000000003) -| (154.74256000000003,178.80981);
\draw[species border] (0,210.01977) -- (0,240.01977) -- node[species label] {X} (74.4,240.01977) -- (74.4,210.01977);
\draw[species border] (154.74256000000003,178.80981) -- (154.74256000000003,240.01977) -- node[species label] {Y} (231.62256000000002,240.01977) -- (231.62256000000002,178.80981);
\draw[species border] (322.50359000000003,210.01977) -- (322.50359000000003,240.01977) -- node[species label] {Z} (391.34359000000006,240.01977) -- (391.34359000000006,210.01977);
\draw[species border] (457.78052500000007,194.46978000000001) |- (519.6805250000001,153.18988000000002) -- (519.6805250000001,143.18988000000002);
\draw[species border] (602.0431050000001,174.79983000000001) |- (557.9231050000001,153.18988000000002) -- (557.9231050000001,143.18988000000002);
\draw[species border] (519.6805250000001,194.46978000000001) |- (519.6805250000001,174.79983000000001) -| (557.9231050000001,174.79983000000001);
\draw[species border] (457.78052500000007,194.46978000000001) -- (457.78052500000007,240.01977000000002) -- node[species label] {W} (519.6805250000001,240.01977000000002) -- (519.6805250000001,194.46978000000001);
\draw[species border] (557.9231050000001,174.79983000000001) -- (557.9231050000001,240.01977) -- node[species label] {T} (602.0431050000001,240.01977) -- (602.0431050000001,174.79983000000001);
% gene branches
\draw[branch] (256.54256000000004,53.71994000000001) |- (431.01923500000004,34.414965) -| (538.801815,143.18988000000002);
\draw[branch] (401.50794500000006,47.969939999999994) -- (457.78052500000007,47.969939999999994);
\draw[branch] (401.50794500000006,47.969939999999994) -| (302.308355,53.71994000000001);
\draw[branch] (416.2635900000001,16.804994999999998) -- (416.2635900000001,0);
\draw[branch] (401.50794500000006,47.969939999999994) |- (416.2635900000001,16.804994999999998) -| (431.01923500000004,34.414965);
\draw[branch] (80.15000000000002,122.03989) |- (302.30835500000006,87.10492500000001) -| (376.92359000000005,210.01977);
\draw[branch] (302.30835500000006,71.55493500000001) -- (302.308355,53.71994000000001);
\draw[branch] (302.30835500000006,87.10492500000001) |- (302.30835500000006,71.55493500000001);
\draw[branch] (101.19999000000001,122.03989) |- (267.067555,103.70990499999999) -| (355.53359000000006,210.01977);
\draw[branch] (246.01756500000005,116.28989000000001) -- (322.50359000000003,116.28989000000001);
\draw[branch] (246.01756500000005,116.28989000000001) -| (135.62127000000004,122.03989);
\draw[branch] (256.54256000000004,70.52493500000001) -- (256.54256000000004,53.71994000000001);
\draw[branch] (246.01756500000005,116.28989000000001) |- (256.54256000000004,70.52493500000001) -| (267.067555,103.70990499999999);
\draw[branch] (135.62127,142.84486500000003) -- (135.62127000000004,122.03989);
\draw[branch] (35.53000000000001,210.01977) |- (135.62127,142.84486500000003) -| (221.09256000000002,178.80981);
\draw[branch] (101.19999000000001,160.479825) -- (101.19999000000001,122.03989);
\draw[branch] (12.75,210.01977) |- (101.19999000000001,160.479825) -| (189.63756,178.80981);
\draw[branch] (80.15000000000002,173.05981000000003) -- (80.15000000000002,122.03989);
\draw[branch] (80.15000000000002,173.05981000000003) -- (154.74256000000003,173.05981000000003);
\draw[branch] (80.15000000000002,173.05981000000003) -| (59.980000000000004,210.01977);
\draw[branch] (59.980000000000004,229.51977) -- (59.980000000000004,210.01977);
\draw[branch] (35.53000000000001,229.51977) -- (35.53000000000001,210.01977);
\draw[branch] (12.75,229.51977) -- (12.75,210.01977);
\draw[branch] (221.09256000000002,229.51977) -- (221.09256000000002,178.80981);
\draw[branch] (185.40256000000002,229.51977) |- (175.68256000000002,210.24477499999998) -| (165.96256000000002,229.51977);
\draw[branch] (189.63756,194.639795) -- (189.63756,178.80981);
\draw[branch] (203.59256000000002,229.51977) |- (189.63756,194.639795) -| (175.68256000000002,210.24477499999998);
\draw[branch] (376.9235900000001,229.51977) -- (376.92359000000005,210.01977);
\draw[branch] (355.5335900000001,229.51977) -- (355.53359000000006,210.01977);
\draw[branch] (335.53359,229.51977) -- (335.53359000000006,210.01977);
\draw[branch] (538.8018150000001,163.99485500000003) -- (538.801815,143.18988000000002);
\draw[branch] (470.8105250000001,194.46978000000001) |- (538.8018150000001,163.99485500000003) -| (581.233105,174.79983000000001);
\draw[branch] (501.4405250000001,210.244775) -- (501.4405250000001,194.46978000000001);
\draw[branch] (510.4005250000001,229.51977000000002) |- (501.4405250000001,210.244775) -| (492.48052500000006,229.51977000000002);
\draw[branch] (470.8105250000001,229.51977000000002) -- (470.8105250000001,194.46978000000001);
\draw[branch] (591.513105,229.51977) |- (581.233105,209.214775) -| (570.953105,229.51977);
\draw[branch] (581.2331050000001,191.604805) -- (581.233105,174.79983000000001);
\draw[branch] (581.233105,209.214775) |- (581.2331050000001,191.604805);
% gene transfers
\draw[transfer branch] (302.30835500000006,71.55493500000001) to[bend left=35] (501.4405250000001,194.46978000000001);
\draw[transfer branch] (581.2331050000001,191.604805) to[bend right=35] (335.53359000000006,210.01977);
% events
\node[speciation] at (431.01923500000004,34.414965) {abcdefg};
\node [loss] at (457.78052500000007,47.969939999999994) {};
\node[duplication] at (416.2635900000001,16.804994999999998) {abcdefg};
\node[speciation] at (302.30835500000006,87.10492500000001) {abcd};
\node[horizontal gene transfer] at (302.30835500000006,71.55493500000001) {abcd};
\node[speciation] at (267.067555,103.70990499999999) {cdef};
\node [loss] at (322.50359000000003,116.28989000000001) {};
\node[duplication] at (256.54256000000004,70.52493500000001) {abcdefg};
\node[speciation] at (135.62127,142.84486500000003) {defg};
\node[speciation] at (101.19999000000001,160.479825) {cdef};
\node [loss] at (154.74256000000003,173.05981000000003) {};
\node[extant gene={abcd}] at (59.980000000000004,221.51977) {};
\node[extant gene={defg}] at (35.53000000000001,221.51977) {};
\node[extant gene={cdef}] at (12.75,221.51977) {};
\node[extant gene={def}] at (221.09256000000002,221.51977) {};
\node[extant gene={cef}] at (203.59256000000002,221.51977) {};
\node[extant gene={cde}] at (185.40256000000002,221.51977) {};
\node[extant gene={cde}] at (165.96256000000002,221.51977) {};
\node[duplication] at (175.68256000000002,210.24477499999998) {cde};
\node[duplication] at (189.63756,194.639795) {cdef};
\node[extant gene={abcd}] at (376.9235900000001,221.51977) {};
\node[extant gene={cef}] at (355.5335900000001,221.51977) {};
\node[extant gene={defg}] at (335.53359,221.51977) {};
\node[speciation] at (538.8018150000001,163.99485500000003) {defg};
\node[extant gene={ab}] at (510.4005250000001,221.51977000000002) {};
\node[extant gene={abc}] at (492.48052500000006,221.51977000000002) {};
\node[duplication] at (501.4405250000001,210.244775) {abc};
\node[extant gene={defg}] at (470.8105250000001,221.51977000000002) {};
\node[extant gene={def}] at (591.513105,221.51977) {};
\node[extant gene={defg}] at (570.953105,221.51977) {};
\node[duplication] at (581.233105,209.214775) {defg};
\node[horizontal gene transfer] at (581.2331050000001,191.604805) {defg};
\end{tikzpicture}
